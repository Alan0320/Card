<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BenQ-Electronic-Name-Card</title>
</head>
<link rel="stylesheet" href="style.css">
<body>
    <div class="bg line">
    <div class="header container mt90">
        <div class="name">
            <h2 class="mb8 fwb"><span id="response_name"></span></h2>            
	    <button id="generateVCard">生成 vCard</button>
            <ul>
            <li><span id="response_title"></span></li>
            <li><span id="response_department"></span></li>
            <li><span id="response_Office"></span></li>
            </ul>
        </div>
    
    <div class="card-body container2">
        <h3 class="mb8">明基材料股份有限公司</h3>
        <ul class="body-item">
            <li><span class="fwb">總部</span> 333403 桃園市龜山區建國東路29號</li>
            <li>
            <li><span class="fwb">電話</span> +886 374-8800 分機<span id="response_phonenumbe"></span></li>
            <ul class="df jcsb ulrwd">
                <li><span class="fwb">傳真</span> +886 374-8870</li>
                <li>  </li>
                <li><span class="fwb">統一編號</span> 16549778</li>
            </ul>

            <li><span id="response_email"></span></li>
            <li>BenQMaterials.com</li>
        </ul>

    </div>
    </div>
</div>
</body>

<script>
    // 替換為您部署的 Google Apps Script URL
    var scriptUrl = 'https://script.google.com/macros/s/AKfycbxGdvKDiEIzawywI6q8wSTcwz9DT4U0ExCm4Yv7QWJO6t8mwQObkhJKGjPRlK3G7bn_/exec';

    // 获取网址参数的函数
    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    }

    // 调用 Google Apps Script 函数并获取结果
    function doGet() {
        var vid = getUrlParameter('id'); // 从网址参数中获取 id 值

        var vindex_id = 0;
        var vindex_name = 1;
        var vindex_mail = 2;
        var vindex_phone = 3;
        var vindex_title = 4;
        var vindex_department = 5;
        var vindex_Office = 6;
        fetch(scriptUrl + '?id=' + vid + '&index=' + vindex_name)
            .then(function(response) {
                return response.text();
            })
            .then(function(data) {
                var responseElement = document.getElementById('response_name');
                responseElement.textContent = data;
            })
            .catch(function(error) {
                console.log('Error:', error);
            });

        fetch(scriptUrl + '?id=' + vid + '&index=' + vindex_mail)
            .then(function(response) {
                return response.text();
            })
            .then(function(data) {
                var responseElement = document.getElementById('response_email');
                responseElement.textContent = data;
            })
            .catch(function(error) {
                console.log('Error:', error);
            });
        fetch(scriptUrl + '?id=' + vid + '&index=' + vindex_phone)
            .then(function(response) {
                return response.text();
            })
            .then(function(data) {
                var responseElement = document.getElementById('response_phonenumbe');
                responseElement.textContent = data;
            })
            .catch(function(error) {
                console.log('Error:', error);
            });
        fetch(scriptUrl + '?id=' + vid + '&index=' + vindex_title)
            .then(function(response) {
                return response.text();
            })
            .then(function(data) {
                var responseElement = document.getElementById('response_title');
                responseElement.textContent = data;
            })
            .catch(function(error) {
                console.log('Error:',
